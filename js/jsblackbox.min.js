/*! jsblackbox - v0.0.2 - 2014-07-17
* http://jsblackbox.tk
* Copyright (c) 2014 ; Licensed  */
function Terminal(invalues,validvalues,func){this.inValues=invalues||[1,2,3],this.validValues=validvalues||[1,2,3],this.program="",this.func=func||"function() {return 1;}",this.status=!1,this.verificationFunction=void 0;var self=this;return this._get=function(){return{input:self.inValues,valid:self.validValues}},this._program=function(a){return""!==a?(self.program=a,!0):!1},this._generateVerificationValues=function(verificationFunction){"undefined"!=typeof verificationFunction&&eval("self.verificationFunction = "+verificationFunction);var key,verificationValues=self.verificationFunction();eval("var func = "+self.func);for(key in verificationValues){var value=verificationValues[key];self.inValues.push(value),self.validValues.push(func(value))}},this._status=function(){return self.status},this._process=function(){try{var func;if(eval("var func = "+self.program),"function"!=typeof func)throw new Error("System can accept functions only.");for(var result=[],status=!0,i=0;i<self.inValues.length;i++){var value=func(_.clone(self.inValues[i])),st=_.isEqual(value,self.validValues[i]);result.push({value:value,passed:st}),st||(status=!1)}return self.status=status,result}catch(e){throw e}},{get:this._get,program:this._program,status:this._status,process:this._process,verification:this._generateVerificationValues}}if(function(a){function b(b){a(".level-circle").hide().remove();var d,g=0;e=[];var h=JSON.parse(localStorage.getItem("wonLevels"))||[];for(d in b)g++,e.push(b[d]);var i={width:window.innerWidth,height:window.innerHeight},j={x:i.width/2,y:i.height/2},k=i.height<i.width?i.height/100*75:i.width/100*75,l=(i.width-k)/2,m=(i.height-k)/2,n=a(a(".circle").length>0?".circle":"<div></div>");n.css({position:"absolute",width:k+"px",height:k+"px",border:"1px solid green",left:l+"px",top:m+"px",borderRadius:"50%"}).addClass("circle").appendTo(a(".circle-container"));var o=2*Math.PI/g,p=0,q=0;for(d in b){var r=a("<div></div>").css({position:"absolute",left:j.x+k/2*Math.cos(p)-k/20+"px",top:j.y+k/2*Math.sin(p)-k/20+"px",backgroundColor:-1!==h.indexOf(q)?"lightgreen":"#ccc",width:k/10+"px",height:k/10+"px",border:"1px solid green",borderRadius:"50%"}).hide().addClass("level-circle").append(a("<p></p>").text(q+1).css({display:"block",margin:"0px auto",position:"relative",width:"10px"}));r.find("p").css({marginTop:(parseInt(r.height())/2-parseInt(r.find("p").height())/2)/2+"px"}),r.attr("data-level",b[d].id),function(a){r.off("click").on("click",function(){f=a,c(e[a])})}(q),r.appendTo(a(".circle-container")).show(),p+=o,q++}}function c(b){a(".success-wrapper").hide(),a(".tuning").find("tr").remove(),a(".console").text("function(param) {return 1;}"),a(".message").text(""),a(".error").hide(),a(".name").text("Terminal: "+b.id),a(".message").html(b.description),a(".next").off("click").on("click",function(){f++,"undefined"!=typeof e[f]?c(e[f]):(d("hide"),a(".comments").hide(),a(".overview").hide(),a(".finish").show(),a(".info").show())}),b.input=b.input.slice(0,3),b.output=b.output.slice(0,3);var g=new Terminal(b.input,b.output,b.func);g.verification(b.verFunc);for(var h=0;h<g.get().input.length;h++){var i=a("<tr></tr>"),j=a("<td></td>").text(b.input[h]),k=a("<td></td>"),l=a("<td></td>").text(b.output[h]);i.append(j).append(k).append(l),i.appendTo(a(".tuning"))}!function(c){a(".run").off("click").on("click",function(){var d=a(".error"),g=a(".tuning");d.hide(),c.program(a(".console").text());try{c.process(),c.verification();var h=c.process();g.find("tr").remove();for(var i=0;i<c.get().input.length;i++){var j=a("<tr></tr>"),k=a("<td></td>").text(b.input[i]),l=a("<td></td>").text(h[i].value).css({backgroundColor:h[i].passed?"#27ae60":"#e74c3c"}),m=a("<td></td>").text(b.output[i]);j.append(k).append(l).append(m),j.appendTo(g)}if(c.status()){d.hide(),a(".success").css({marginTop:(a(".success-wrapper").height()/2-a(".success").height()/2)/2+"px"}),a(".success-wrapper").show();var n=JSON.parse(localStorage.getItem("wonLevels"))||[];-1===n.indexOf(i)&&(n.push(f),localStorage.setItem("wonLevels",JSON.stringify(n))),a("div[data-level="+e[f].id.replace(/\./g,"\\.")+"]").css({backgroundColor:"lightgreen"})}}catch(o){d.text("# "+o.toString()),d.show()}})}(g),d("open",void 0,function(){a(".panel").css({height:a(".level-container").height()-a(".description-wrapper").height()-75+"px"})})}function d(b,c,d){b.data&&(b=b.data.action),"undefined"==typeof c&&(c=a(".level-container")),"open"===b?(c.show(),c.animate({top:"10%",height:"90%"},100,function(){"undefined"!=typeof d&&d()})):c.animate({height:"0%",top:"100%"},100,function(){c.hide()})}var e,f=0;a.get("levels/levels.jsbl").success(function(c){for(var d="",e=0;e<c.length;e++)d+=String.fromCharCode(7^c.charCodeAt(e));c=JSON.parse(d),b(c),window.onresize=function(){b(c),a(".panel").css({height:a(".level-container").height()-a(".description-wrapper").height()-75+"px"})}}),a(".cross").click(function(){d("close")}),a(".cross-popup").click(function(){a(".info").hide()}),a(".js-info").click(function(){a(".info").show(),a(".overview").show(),a(".select-level").show(),a(".comments").hide(),a(".finish").hide()}),a(".js-disqus").click(function(){a(".info").show(),a(".overview").hide(),a(".select-level").hide(),a(".finish").hide(),a(".comments").show()}),a(".select-level").click(function(){a(".info").hide(),d("close")}),a(window).on("scroll",function(a){a.preventDefault(),window.scrollTo(0,0)})}(jQuery),"undefined"!=typeof module)var _=require("underscore");"undefined"!=typeof module&&(module.exports.Terminal=Terminal);